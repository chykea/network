### 如果在DNS查询过程中，域名服务器之间的请求和响应报文丢失了，会怎么处理？
这个问题主要想问的是DNS是基于什么协议进行传输的

>DNS可以使用TCP协议，也可以使用UDP协议，端口号为53

DNS在<b>查询过程</b>中，使用的是UDP协议，因为一般查询的内容不超过512个字节，即使请求报文或响应报文丢失了，只需要再请求一次即可。

在了解DNS在哪里使用TCP协议时，你需要了解主域名服务器和辅助域名服务器这两个概念。由于网上没有详细的说明这两个到底指的是什么，这里我根据我查的资料来给出自己的理解。

#### 主域名服务器
在进行DNS查询时，通常本地域名服务器会去请求根域名服务器、顶级域名服务器和权限域名服务器。这一类服务器其实就相当于主域名服务器（这里只是为了解释主域名服务器这个概念，实际上并没有直接请求到这些服务器）。

#### 辅助域名服务器
上面有提及到，如果直接请求主域名服务器，如果有黑客恶意攻击主域名服务器，那必然会导致数据泄露，严重时会导致DNS域名系统奔溃。为了防止这类情况，我们需要一个东西来隐藏我们的主域名服务器，但又能让外界能够获取到信息，这时候辅助域名服务器就派上用场了。
辅助域名服务器从主域名服务器中拷贝数据信息，然后在进行DNS查询的时候，通常都是访问这些辅助域名服务器，即实际在进行DNS查询的时候参与查询过程的就是这些辅助域名服务器。


了解了主域名服务器、辅助域名服务器之后，接下来就要讲讲DNS为什么要用到TCP协议了。

在提及辅助域名服务器时有讲到，通过拷贝主域名服务器来让外界进行访问。但是主域名服务器中的数据其实并不是一成不变的（虽然域名信息基本很少变动），所以辅助域名需要定时的询问主域名服务器中的数据是否变动了（一般是3个小时）。如果变动，执行一次区域传输。
而这个区域传输，就是这里用到了TCP协议。

因为数据变动可能会很大，要保证数据传输正确可靠，所以需要TCP协议来保证可靠传输。




